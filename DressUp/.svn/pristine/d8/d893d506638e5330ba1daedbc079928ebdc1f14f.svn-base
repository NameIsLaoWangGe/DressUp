import { Core, UIBase, TweenMgr, DataMgr, EventMgr, GameMgr, UIMgr, SceneMgr } from "../../Frame/Core";

import Util from "../../Frame/Util";
import RecordManager from "./RecordManager";
import ADManager from "../../Admanager";
import GameDataController from "../GameDataController";
import ClothChange from "../ClothChange";
import BagListController from "./Bag/BagListController";


export default class UIReady extends UIBase
{

    ClothOpenBtn: Laya.Image;
    ADBG: Laya.Label;
    BtnBar: Laya.Box;
    ShowView: Laya.Box;

    clothisopen = true;

    Ubag: Core.Tween.Tweener;
    Dbag: Core.Tween.Tweener;
    Rbtn: Core.Tween.Tweener;
    Lbtn: Core.Tween.Tweener;
    btnU: Core.Tween.Tweener;
    btnD: Core.Tween.Tweener;
    FRS: Core.Tween.Tweener;
    FRB: Core.Tween.Tweener;

    windowwidth: number;
    windowheight: number;
    FemaleRoot: Laya.Box;


    newmap: Map<string, number> = new Map<string, number>()

    BagAll: Laya.Box;

    ClothReceive: Laya.Image;
    onInit()
    {
        this.windowheight = Laya.Browser.height;
        this.windowwidth = Laya.Browser.width;
        if (Laya.LocalStorage.getItem("Sign"))
        {

        }
        else
        {
            GameDataController.setFirstLoginTime();
        }

        this.btnEv("ClothOpenBtn", this.ClothOpenBtnClick);
        this.btnEv("ActiveBtn", this.ActiveClick);
        this.btnEv("ClothReceive", () =>
        {
            ClothChange.Instance.ClothReceive();
            BagListController.Instance.ClothesPageChange(BagListController.Instance.SelectIndex)
        });

        this.ShowView = this.vars("ShowView");
        this.BtnBar = this.vars("BtnBar");
        this.ClothOpenBtn = this.vars("ClothOpenBtn");
        this.FemaleRoot = this.vars("FemaleRoot");
        this.BagAll = this.vars("BagALL");
        this.Ubag = TweenMgr.tweenCust(300, this, this.tweenbagUp, null, true, Laya.Ease.linearNone);
        this.Lbtn = TweenMgr.tweenCust(300, this, this.tweenbtnLeft, null, true, Laya.Ease.linearNone);
        this.btnU = TweenMgr.tweenCust(200, this, this.RoteUp, null, true, Laya.Ease.linearNone);
        this.FRS = TweenMgr.tweenCust(300, this, this.tweenFBTSmall, null, true, Laya.Ease.backIn);

        this.Dbag = TweenMgr.tweenCust(300, this, this.tweenbagDown, null, true, Laya.Ease.backOut);
        this.Rbtn = TweenMgr.tweenCust(300, this, this.tweenbtnRight, null, true, Laya.Ease.backOut);
        this.btnD = TweenMgr.tweenCust(200, this, this.RoteDown, null, true, Laya.Ease.linearNone);
        this.FRB = TweenMgr.tweenCust(300, this, this.tweenFBTBig, null, true, Laya.Ease.backOut);

        console.log("this.newmap", GameDataController.ClothDataAsy);
        if (GameDataController.IsNewDay())
        {
            console.log("GameDataController.IsNewDay", GameDataController.TodaySign);
            GameDataController.TodaySign = "0";
        }
        let havesign = GameDataController.TodaySign;
        if (havesign)
        {
            if (havesign == "1")
            {

            }
            else
            {
                UIMgr.show("UISign");
            }
        }
        else
        {
            UIMgr.show("UISign");
            GameDataController.TodaySign = "0";
        }

    }
    ActiveClick()
    {
        UIMgr.show("UIActive");
    }

    buyFun()
    {

    }
    RefreshUI()
    {

    }
    onShow()
    {
        this.RefreshUI();

        //UIMgr.show("UISign");
    }

    onHide()
    {

    }
    ClothOpenBtnClick()
    {
        if (this.clothisopen)
        {
            console.log("消失");
            this.Dbag.play();
            //this.Rbtn.play();
            this.btnU.play();
            this.FRB.play();
            let a: Map<string, number> = Laya.LocalStorage.getJSON("ClothData");

        }
        else
        {
            console.log("展示");
            //this.Lbtn.play();
            this.Ubag.play();
            this.btnD.play();
            this.FRS.play();
        }
        this.clothisopen = !this.clothisopen;
    }
    RoteDown(t: Core.Tween.Tweener)
    {
        let nbtm: number = this.ClothOpenBtn.rotation;
        TweenMgr.lerp_Num(nbtm, 180, t);
        this.ClothOpenBtn.rotation = t.outParams[0][0];
    }
    RoteUp(t: Core.Tween.Tweener)
    {
        let nbtm: number = this.ClothOpenBtn.rotation;
        TweenMgr.lerp_Num(nbtm, 0, t);
        this.ClothOpenBtn.rotation = t.outParams[0][0];
    }


    tweenbagUp(t: Core.Tween.Tweener)
    {
        let nbtm: number = this.BagAll.bottom;
        TweenMgr.lerp_Num(nbtm, 0, t);
        this.BagAll.bottom = t.outParams[0][0];
    }
    tweenbagDown(t: Core.Tween.Tweener)
    {
        let nbtm: number = this.BagAll.bottom;
        TweenMgr.lerp_Num(nbtm, -485, t);
        this.BagAll.bottom = t.outParams[0][0];

    }
    tweenbtnLeft(t: Core.Tween.Tweener)
    {
        let nX: number = this.BtnBar.x;
        TweenMgr.lerp_Num(nX, 75, t);
        this.BtnBar.x = t.outParams[0][0];
    }
    tweenbtnRight(t: Core.Tween.Tweener)
    {
        let nX: number = this.BtnBar.x;
        TweenMgr.lerp_Num(nX, GameDataController.windowWidth - 75, t);
        this.BtnBar.x = t.outParams[0][0];
    }

    tweenFBTSmall(t: Core.Tween.Tweener)
    {
        let nX: number = this.FemaleRoot.scaleX;
        TweenMgr.lerp_Num(nX, 1, t);
        this.FemaleRoot.scaleX = this.FemaleRoot.scaleY = t.outParams[0][0];
    }
    tweenFBTBig(t: Core.Tween.Tweener)
    {
        let nX: number = this.FemaleRoot.scaleX;
        TweenMgr.lerp_Num(nX, 1.3, t);
        this.FemaleRoot.scaleX = this.FemaleRoot.scaleY = t.outParams[0][0];
    }
    onClick_Btnshortcut()
    {
        UIMgr.show("UIMain");
    }

}