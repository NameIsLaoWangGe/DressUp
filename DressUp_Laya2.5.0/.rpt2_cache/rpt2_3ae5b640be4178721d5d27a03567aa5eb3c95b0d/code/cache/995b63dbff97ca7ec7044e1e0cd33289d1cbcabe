{
  "code": "import PromoItem from \"./PromoItem\";\r\nimport Behaviour from \"./Behaviour\";\r\nexport default class P205 extends Behaviour {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.promoList = null;\r\n        this.itemList = [];\r\n        this.scroll = null;\r\n        this.layout = null;\r\n        this.prefab = null;\r\n        this.paddingTop = 10;\r\n        this.paddingBottom = 10;\r\n        this.move = null;\r\n        this.show = null;\r\n        this.hide = null;\r\n        this.maxX = 620;\r\n        this.line = 0;\r\n        this.column = 0;\r\n        this.targetX = 0;\r\n        this.showing = [];\r\n    }\r\n    async OnAwake() {\r\n        this.move = this.owner.getChildByName(\"move\");\r\n        let button = this.move.getChildByName(\"button\");\r\n        this.show = button.getChildByName(\"show\");\r\n        this.hide = button.getChildByName(\"hide\");\r\n        let board = this.move.getChildByName(\"board\");\r\n        this.scroll = board.getChildByName(\"scroll\");\r\n        this.layout = this.scroll.getChildByName(\"layout\");\r\n        this.prefab = this.layout.getCell(0);\r\n        this.show.clickHandler = new Laya.Handler(null, () => { this.Show(); });\r\n        this.hide.clickHandler = new Laya.Handler(null, () => { this.Hide(); });\r\n        let w = this.scroll.width - this.paddingTop - this.paddingBottom;\r\n        while (w >= this.prefab.width) {\r\n            w = w - this.prefab.width - this.layout.spaceX;\r\n            this.column++;\r\n        }\r\n        TJ.Develop.Yun.Promo.Data.ReportAwake(P205.style);\r\n        if (this.show.parent.scaleX < 0)\r\n            this.maxX = -this.maxX;\r\n        if (TJ.API.AppInfo.Channel() == TJ.Define.Channel.AppRt.ZJTD_AppRt) {\r\n            if (Laya.Browser.onIOS) {\r\n                this.active = false;\r\n                return;\r\n            }\r\n            return;\r\n        }\r\n        this.active = false;\r\n        this.promoList = await TJ.Develop.Yun.Promo.List.Get(P205.style);\r\n        if (this.promoList.count > 0) {\r\n            TJ.Develop.Yun.Promo.Data.ReportStart(P205.style);\r\n            this.line = Math.ceil(this.promoList.count / this.column);\r\n            this.layout.repeatX = this.column;\r\n            this.layout.repeatY = this.line;\r\n            for (let i = 0; i < this.layout.cells.length; i++) {\r\n                let node = this.layout.getCell(i);\r\n                if (i < this.promoList.count) {\r\n                    let item = node.getComponent(PromoItem);\r\n                    if (item != null) {\r\n                        this.itemList.push(item);\r\n                        item.style = P205.style;\r\n                    }\r\n                    node.active = node.visible = true;\r\n                }\r\n                else {\r\n                    node.active = node.visible = false;\r\n                }\r\n            }\r\n            this.line = Math.ceil(this.itemList.length / this.column);\r\n            let h = this.paddingTop + this.paddingBottom;\r\n            h += this.prefab.height * this.line + this.layout.spaceY * (this.line - 1);\r\n            this.layout.height = h;\r\n            if (this.scroll.height < this.layout.height) {\r\n                this.scroll.vScrollBarSkin = \"\";\r\n                this.scroll.vScrollBar.rollRatio = 0;\r\n            }\r\n            for (let item of this.itemList) {\r\n                this.LoadIcon(item);\r\n            }\r\n            this.active = true;\r\n        }\r\n        else {\r\n            this.owner.destroy();\r\n        }\r\n    }\r\n    get scrollValue() {\r\n        if (this.scroll.vScrollBar != null) {\r\n            return this.scroll.vScrollBar.value;\r\n        }\r\n        return 0;\r\n    }\r\n    set scrollValue(v) {\r\n        if (this.scroll.vScrollBar != null) {\r\n            this.scroll.vScrollBar.value = v;\r\n        }\r\n    }\r\n    LoadIcon(promoItem) {\r\n        let data = this.promoList.Load();\r\n        if (data != null) {\r\n            this.promoList.Unload(promoItem.data);\r\n            promoItem.data = data;\r\n            promoItem.onClick_ = (item) => { this.LoadAndShowIcon(item); };\r\n            promoItem.DoLoad();\r\n        }\r\n        return data;\r\n    }\r\n    LoadAndShowIcon(promoItem) {\r\n        if (this.LoadIcon(promoItem) != null) {\r\n            promoItem.OnShow();\r\n        }\r\n    }\r\n    Show() {\r\n        if (TJ.API.AppInfo.Channel() == TJ.Define.Channel.AppRt.ZJTD_AppRt) {\r\n            let param = new TJ.API.Promo.Param();\r\n            param.extraData = { \"TJ_App\": TJ.API.AppInfo.AppGuid() };\r\n            TJ.API.Promo.Pop(param);\r\n            return;\r\n        }\r\n        this.targetX = this.maxX;\r\n        this.show.active = this.show.visible = false;\r\n        this.hide.active = this.hide.visible = true;\r\n        this.scrollValue = 0;\r\n    }\r\n    Hide() {\r\n        this.targetX = 0;\r\n        this.showing = [];\r\n    }\r\n    OnUpdate() {\r\n        let deltaTime = Laya.timer.delta / 1000;\r\n        if (this.move.centerX != this.targetX) {\r\n            let d = this.targetX - this.move.centerX;\r\n            let s = 3000 * deltaTime;\r\n            if (d > 0) {\r\n                d = Math.min(this.move.centerX + s, this.targetX);\r\n            }\r\n            else {\r\n                d = Math.max(this.move.centerX - s, this.targetX);\r\n            }\r\n            this.move.centerX = d;\r\n            if (this.move.centerX == 0) {\r\n                this.show.active = this.show.visible = true;\r\n                this.hide.active = this.hide.visible = false;\r\n                window.setTimeout(async () => {\r\n                    this.promoList = await TJ.Develop.Yun.Promo.List.Get(P205.style);\r\n                    for (let item of this.itemList) {\r\n                        this.LoadIcon(item);\r\n                    }\r\n                }, 0);\r\n            }\r\n        }\r\n        else {\r\n            if (this.move.centerX == this.maxX) {\r\n                this.CheckShow();\r\n            }\r\n        }\r\n    }\r\n    CheckShow() {\r\n        for (let item of this.itemList) {\r\n            let i = this.showing.indexOf(item);\r\n            let node = item.owner;\r\n            let d = Math.abs(-node.y - this.paddingTop - this.prefab.height / 2 + this.scrollValue + this.scroll.height / 2);\r\n            if (d < this.scroll.height / 2) {\r\n                if (i < 0) {\r\n                    this.showing.push(item);\r\n                    item.OnShow();\r\n                }\r\n            }\r\n            else {\r\n                if (i >= 0) {\r\n                    this.showing.splice(i, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nP205.style = \"P205\";\r\n//# sourceMappingURL=P205.js.map",
  "references": [
    "C:/Users/tomato/Downloads/Baby/Baby/src/TJ/Promo/script/PromoItem.ts",
    "C:/Users/tomato/Downloads/Baby/Baby/src/TJ/Promo/script/Behaviour.ts"
  ],
  "map": "{\"version\":3,\"file\":\"P205.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/TJ/Promo/script/P205.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
