{
  "code": "import GameDataController from \"../GameDataController\";\r\nimport { UIMgr } from \"../../Frame/Core\";\r\nimport BagListController from \"./Bag/BagListController\";\r\nimport ADManager, { TaT } from \"../../Admanager\";\r\nexport default class ActiveItem extends Laya.Script {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.Datas = [];\r\n        this.Icons = [];\r\n        this.Num = 0;\r\n        this.MaxHeight = 85;\r\n        this.MaxWeight = 85;\r\n        this.str = {};\r\n    }\r\n    onAwake() {\r\n        let item = this.owner;\r\n        this.Bg = item.getChildByName(\"Bg\");\r\n        this.IconParent = item.getChildByName(\"IconParent\");\r\n        this.IconAll = this.IconParent.getChildByName(\"IconAll\");\r\n        this.ClothShow = item.getChildByName(\"ClothShow\");\r\n        for (let i = 0; i < this.ClothShow.numChildren; i++) {\r\n            this.Icons.push(this.ClothShow.getChildAt(i).getChildAt(0));\r\n        }\r\n        this.ADBtn = item.getChildByName(\"ADBtn\");\r\n        this.TaskPre = this.ADBtn.getChildByName(\"TaskPre\");\r\n        this.ADBtn.on(Laya.Event.CLICK, this, this.adclick);\r\n        this.PackName = item.getChildByName(\"PackName\");\r\n    }\r\n    fell(mes, index) {\r\n        let iconpath = \"Active/taozhuang\" + (index + 1) + \".png\";\r\n        let PackNamepath = \"Active/Pack\" + (index + 1) + \".png\";\r\n        this.Datas = mes;\r\n        this.IconAll.skin = iconpath;\r\n        this.PackName.skin = PackNamepath;\r\n        console.log(this.Datas);\r\n        this.Icons.forEach((v, i) => {\r\n            console.log(\"橱窗\" + i + v);\r\n            if (i < this.Datas.length) {\r\n                v.visible = true;\r\n                v.skin = this.Datas[i].GetPath1();\r\n                let imageHeight = parseFloat(v.height.toString());\r\n                let imagewidth = parseFloat(v.width.toString());\r\n                let pr = 0;\r\n                if (imagewidth > imageHeight) {\r\n                    pr = this.MaxWeight / imagewidth;\r\n                }\r\n                else {\r\n                    pr = this.MaxHeight / imageHeight;\r\n                }\r\n                v.scaleX = pr;\r\n                v.scaleY = pr;\r\n                v.centerX = 0;\r\n                v.centerY = 0;\r\n            }\r\n            else {\r\n                v.visible = false;\r\n            }\r\n        });\r\n        this.Datas.forEach((v, i) => {\r\n            let nv = GameDataController.ClothDataRefresh[this.Datas[i].ID];\r\n            this.str[this.Datas[i].ID] = nv;\r\n            console.log(GameDataController.ClothDataRefresh[this.Datas[i].ID]);\r\n        });\r\n        console.log(this.str);\r\n        GameDataController.ClothdatapackSet(this.Datas[0].GetType2, this.str);\r\n        console.log(this.Datas[0].GetType2, this.str);\r\n        this.Num = GameDataController.ClothAlllockNum(this.str);\r\n        console.log(\"未解锁数量\", this.Num);\r\n        this.Now = (this.Datas.length - this.Num) + \"\";\r\n        this.Need = (this.Datas.length) + \"\";\r\n        this.TaskPre.text = this.Now + \" / \" + this.Need;\r\n        this.ADBtn.visible = this.Num > 0;\r\n        if (this.ADBtn.visible) {\r\n            if (this.Datas[0].GetType2 == \"2_1\") {\r\n                ADManager.TAPoint(TaT.BtnShow, \"ADtz1_click\");\r\n            }\r\n            else if (this.Datas[0].GetType2 == \"2_2\") {\r\n                ADManager.TAPoint(TaT.BtnShow, \"ADtz2_click\");\r\n            }\r\n            else if (this.Datas[0].GetType2 == \"2_3\") {\r\n                ADManager.TAPoint(TaT.BtnShow, \"ADhunsha_click\");\r\n            }\r\n        }\r\n        for (let index = 0; index < this.ClothShow.numChildren; index++) {\r\n            if (index >= this.Datas.length) {\r\n                this.ClothShow.getChildAt(index).visible = false;\r\n            }\r\n        }\r\n    }\r\n    adclick() {\r\n        if (this.Datas[0].GetType2 == \"2_1\") {\r\n            ADManager.TAPoint(TaT.BtnClick, \"ADtz1_click\");\r\n        }\r\n        else if (this.Datas[0].GetType2 == \"2_2\") {\r\n            ADManager.TAPoint(TaT.BtnClick, \"ADtz2_click\");\r\n        }\r\n        else if (this.Datas[0].GetType2 == \"2_3\") {\r\n            ADManager.TAPoint(TaT.BtnClick, \"ADhunsha_click\");\r\n        }\r\n        ADManager.ShowReward(() => {\r\n            this.GetAward();\r\n        }, () => {\r\n            UIMgr.show(\"UITip\", () => {\r\n                this.GetAward();\r\n            });\r\n        });\r\n    }\r\n    GetAward() {\r\n        for (let k in this.str) {\r\n            if (this.str[k] == 1) {\r\n                console.log(\"GameDataController.ClothDataRefresh[k]\", k, GameDataController.ClothDataRefresh[k]);\r\n                let dataall = GameDataController.ClothDataRefresh;\r\n                dataall[k] = 0;\r\n                GameDataController.ClothDataRefresh = dataall;\r\n                console.log(this.str, this.Datas[0].GetType2);\r\n                Laya.LocalStorage.setJSON(this.Datas[0].GetType2, this.str);\r\n                UIMgr.get(\"UIActive\").Refresh();\r\n                BagListController.Instance.showList();\r\n                UIMgr.tip(\"恭喜获得新衣服\");\r\n                return;\r\n            }\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=ActiveItem.js.map",
  "references": [
    "D:/Game/project/DressUp/Project_Laya2.5.0/DressUp_Laya2.5.0/src/script/Game/ClothData.ts",
    "D:/Game/project/DressUp/Project_Laya2.5.0/DressUp_Laya2.5.0/src/script/Game/GameDataController.ts",
    "D:/Game/project/DressUp/Project_Laya2.5.0/DressUp_Laya2.5.0/src/script/Frame/Core.ts",
    "D:/Game/project/DressUp/Project_Laya2.5.0/DressUp_Laya2.5.0/src/script/Game/UI/UIActive.ts",
    "D:/Game/project/DressUp/Project_Laya2.5.0/DressUp_Laya2.5.0/src/script/Game/UI/Bag/BagListController.ts",
    "D:/Game/project/DressUp/Project_Laya2.5.0/DressUp_Laya2.5.0/src/script/Admanager.ts"
  ],
  "map": "{\"version\":3,\"file\":\"ActiveItem.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/script/Game/UI/ActiveItem.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
