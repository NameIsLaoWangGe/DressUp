{
  "code": "import PromoItem from \"./PromoItem\";\r\nimport Behaviour from \"./Behaviour\";\r\nexport default class P106 extends Behaviour {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.promoList = null;\r\n        this.itemList = [];\r\n        this.layout = null;\r\n        this.showing = [];\r\n    }\r\n    async OnAwake() {\r\n        this.scrollView = this.owner.getChildByName(\"scroll\");\r\n        this.layout = this.scrollView.getChildByName(\"layout\");\r\n        this.scrollView.vScrollBarSkin = \"\";\r\n        let close = this.owner.getChildByName(\"close\");\r\n        close.clickHandler = new Laya.Handler(null, () => { this.OnClose(); });\r\n        TJ.Develop.Yun.Promo.Data.ReportAwake(P106.style);\r\n        this.active = false;\r\n        if (Laya.Browser.onIOS && TJ.API.AppInfo.Channel() == TJ.Define.Channel.AppRt.ZJTD_AppRt)\r\n            return;\r\n        let list = await TJ.Develop.Yun.Promo.List.Get(P106.style);\r\n        if (this.promoList == null)\r\n            this.promoList = list;\r\n        if (this.promoList.count > 0) {\r\n            TJ.Develop.Yun.Promo.Data.ReportStart(P106.style);\r\n            this.layout.repeatY = this.promoList.count;\r\n            let h = 0;\r\n            for (let i = 0; i < this.layout.cells.length; i++) {\r\n                let node = this.layout.getCell(i);\r\n                if (i < this.promoList.count) {\r\n                    let item = node.getComponent(PromoItem);\r\n                    if (item != null) {\r\n                        this.itemList.push(item);\r\n                        item.style = P106.style;\r\n                    }\r\n                    Behaviour.SetActive(node, true);\r\n                }\r\n                else {\r\n                    Behaviour.SetActive(node, false);\r\n                }\r\n                if (i > 0) {\r\n                    h += this.layout.spaceY;\r\n                }\r\n                h += node.height;\r\n            }\r\n            this.layout.height = h;\r\n            for (let item of this.itemList) {\r\n                this.LoadIcon(item);\r\n            }\r\n            this.active = true;\r\n        }\r\n        else {\r\n            this.owner.destroy();\r\n        }\r\n    }\r\n    OnEnable() {\r\n        this.scrollValue = 0;\r\n    }\r\n    async OnDisable() {\r\n        this.promoList = await TJ.Develop.Yun.Promo.List.Get(P106.style);\r\n        for (let item of this.itemList) {\r\n            this.LoadIcon(item);\r\n        }\r\n    }\r\n    OnUpdate() {\r\n        this.CheckShow();\r\n    }\r\n    LoadIcon(promoItem) {\r\n        let data = this.promoList.Load();\r\n        if (data != null) {\r\n            this.promoList.Unload(promoItem.data);\r\n            promoItem.data = data;\r\n            promoItem.onClick_ = (item) => { this.LoadIcon(item); };\r\n            promoItem.DoLoad();\r\n            let i = this.showing.indexOf(promoItem);\r\n            if (i >= 0) {\r\n                this.showing.splice(i, 1);\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n    get scrollValue() {\r\n        if (this.scrollView.vScrollBar != null) {\r\n            return this.scrollView.vScrollBar.value;\r\n        }\r\n        return 0;\r\n    }\r\n    set scrollValue(v) {\r\n        if (this.scrollView.vScrollBar != null) {\r\n            this.scrollView.vScrollBar.value = v;\r\n        }\r\n    }\r\n    CheckShow() {\r\n        for (let item of this.itemList) {\r\n            let node = item.owner;\r\n            let d = Math.abs(node.y - this.scrollValue - this.scrollView.height / 2 + node.height / 2 + this.layout.spaceY);\r\n            let i = this.showing.indexOf(item);\r\n            if (d < this.scrollView.height / 2) {\r\n                if (i < 0) {\r\n                    this.showing.push(item);\r\n                    item.OnShow();\r\n                }\r\n            }\r\n            else {\r\n                if (i >= 0) {\r\n                    this.showing.splice(i, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    OnClose() {\r\n        let node = this.owner;\r\n        node.active = node.visible = false;\r\n    }\r\n}\r\nP106.style = \"P106\";\r\n//# sourceMappingURL=P106.js.map",
  "references": [
    "D:/Game/project/DressUp/Project_Laya2.5.0/DressUp_Laya2.5.0/src/TJ/Promo/script/PromoItem.ts",
    "D:/Game/project/DressUp/Project_Laya2.5.0/DressUp_Laya2.5.0/src/TJ/Promo/script/Behaviour.ts"
  ],
  "map": "{\"version\":3,\"file\":\"P106.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/TJ/Promo/script/P106.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
